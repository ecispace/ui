<div class="row mt-10">
  <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.path.label'}}{{field-required}}</label>
  {{input class="form-control" value=config.publishCatalogConfig.path placeholder=(t 'newPipelineStep.stepType.publishCatalog.path.placeholder')}}
  <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.path.helpText' htmlSafe=true}}</p>
</div>

<div class='row'>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.catalog.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.catalog placeholder=(t 'newPipelineStep.stepType.publishCatalog.catalog.placeholder')}}
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.catalog.helpText' htmlSafe=true}}</p>
  </div>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.version.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.version placeholder=(t 'newPipelineStep.stepType.publishCatalog.version.placeholder')}}
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.version.helpText' htmlSafe=true}}</p>
  </div>
</div>

<div class="row">
  <div class="col span-3">
    <div class="radio">
      <label class='pb-5'>
        {{radio-button selection=mode value='http'}} {{t 'newPipelineStep.stepType.publishCatalog.targets.http'}}
      </label>
    </div>
    <div class="radio">
      <label class='pb-5'>
        {{radio-button selection=mode value='ssh'}} {{t 'newPipelineStep.stepType.publishCatalog.targets.ssh'}}
      </label>
    </div>
  </div>
</div>

<div class='row'>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.gitUrl.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.gitUrl placeholder=(if (eq mode 'http')  (t 'newPipelineStep.stepType.publishCatalog.gitUrl.placeholder.http') (t 'newPipelineStep.stepType.publishCatalog.gitUrl.placeholder.ssh'))}}
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.gitUrl.helpText' htmlSafe=true}}</p>
  </div>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.gitBranch.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.gitBranch placeholder=(t 'newPipelineStep.stepType.publishCatalog.gitBranch.placeholder')}}
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.gitBranch.helpText' htmlSafe=true}}</p>
  </div>
</div>

{{#if (eq mode 'http')}}
  <div class="row">
    <div class="col span-6">
      <table class="table fixed no-lines small mb-10">
        <thead>
          <tr class="hidden-sm">
            <th width="220">{{t 'newPipelineStep.stepType.publishCatalog.auth.username.label'}}{{field-required}}</th>
            <th width="10"></th>
            <th>{{t 'fromSecret.prefixOrKey.label'}}{{field-required}}</th>
          </tr>
        </thead>
        <tbody>
          {{form-sources-row
            source=username
            namespace=namespace
            secretOnly=true
            specificKeyOnly=true
            hideAlias=true
          }}
        </tbody>
      </table>
      <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.auth.username.helpText' htmlSafe=true}}</p>
    </div>
    <div class="col span-6">
      <table class="table fixed no-lines small mb-10">
      <thead>
        <tr class="hidden-sm">
          <th width="220">{{t 'newPipelineStep.stepType.publishCatalog.auth.password.label'}}{{field-required}}</th>
          <th width="10"></th>
          <th>{{t 'fromSecret.prefixOrKey.label'}}{{field-required}}</th>
        </tr>
      </thead>
      <tbody>
        {{form-sources-row
          source=password
          namespace=namespace
          secretOnly=true
          specificKeyOnly=true
          hideAlias=true
        }}
      </tbody>
      </table>
      <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.auth.password.helpText' htmlSafe=true}}</p>      
    </div>
  </div>
{{else}}
  <div class="row">
    <div class="col span-12">
      <table class="table fixed no-lines small mb-10">
        <thead>
          <tr class="hidden-sm">
            <th width="220">{{t 'newPipelineStep.stepType.publishCatalog.auth.deployKey.label'}}{{field-required}}</th>
            <th width="10"></th>
            <th>{{t 'fromSecret.prefixOrKey.label'}}{{field-required}}</th>
          </tr>
        </thead>
        <tbody>
          {{form-sources-row
            source=deployKey
            namespace=namespace
            secretOnly=true
            specificKeyOnly=true
            hideAlias=true
          }}
        </tbody>
      </table>
      <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.auth.deployKey.helpText' htmlSafe=true}}</p>
    </div>
  </div>
{{/if}}

<div class='row'>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.gitAuthor.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.gitAuthor placeholder=(t 'newPipelineStep.stepType.publishCatalog.gitAuthor.placeholder')}} 
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.gitAuthor.helpText' htmlSafe=true}}</p>
  </div>
  <div class="col span-6">
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.publishCatalog.gitEmail.label'}}{{field-required}}</label>
    {{input class="form-control" value=config.publishCatalogConfig.gitEmail placeholder=(t 'newPipelineStep.stepType.publishCatalog.gitEmail.placeholder')}}
    <p class="text-info text-small m-0">{{t 'newPipelineStep.stepType.publishCatalog.gitEmail.helpText' htmlSafe=true}}</p>
  </div>
</div>

{{#advanced-section}}
  <div class='row mb-20'>
    <label class='acc-label pb-5'>{{t 'newPipelineStep.stepType.env'}}</label>
    {{form-key-value
      allowMultilineValue=false
      initialMap=config.env
      changed=(action (mut config.env))
      allowEmptyValue=false
      normalHeader=(t 'newContainer.environment.label')
      addActionLabel='newContainer.environment.addAction'
      keyLabel='newContainer.environment.keyLabel'
      keyPlaceholder='newContainer.environment.keyPlaceholder'
      valueLabel='newContainer.environment.valueLabel'
      valuePlaceholder='e.g. bar'
    }}
  </div>

  {{pipeline-condition type="step" config=config.when}}
{{/advanced-section}}
{{top-errors errors=errors}}
{{save-cancel saveDisabled=state.saveDisabled editing=editing createLabel="generic.add" save="save" cancel="cancel"}}